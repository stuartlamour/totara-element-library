Full credit to https://github.com/totara/moodle
Licensing refer to: https://github.com/totara/moodle